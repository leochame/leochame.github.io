<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEOCHAME // CHRONO_ARCHIVE</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <style>
        :root {
            --bg-color: #020205;
            --card-bg: #0b0b10;
            --sidebar-bg: #050508;

            --neon-cyan: #00f3ff;
            --neon-purple: #bc13fe;
            --neon-green: #00ff9d;
            --neon-red: #ff3333;

            --text-main: #e0e0e0;
            --text-muted: #777;

            --font-tech: 'Orbitron', sans-serif;
            --font-code: 'JetBrains Mono', monospace;

            --timeline-width: 4px;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-code);
            overflow-x: hidden;
            /* 复杂的背景纹理 */
            background-image:
                    linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
                    linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* --- Navbar --- */
        .navbar {
            background: rgba(0, 0, 0, 0.9);
            border-bottom: 1px solid rgba(0, 243, 255, 0.15);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }
        .navbar-brand {
            font-family: var(--font-tech);
            color: #fff !important;
            font-weight: 900;
            letter-spacing: 1px;
            text-shadow: 0 0 5px var(--neon-cyan);
        }
        .nav-link { color: var(--text-muted) !important; transition: 0.3s; }
        .nav-link.active { color: var(--neon-cyan) !important; font-weight: bold; text-shadow: 0 0 8px rgba(0, 243, 255, 0.4); }

        /* --- Main Layout --- */
        .archive-layout {
            display: flex;
            min-height: 100vh;
            padding-top: 70px; /* Navbar height */
        }

        /* --- Sidebar HUD (左侧控制台) --- */
        .sidebar-hud {
            width: 280px;
            background: var(--sidebar-bg);
            border-right: 1px solid #222;
            padding: 30px 20px;
            position: fixed;
            height: calc(100vh - 70px);
            overflow-y: auto;
            z-index: 100;
            display: flex;
            flex-direction: column;
        }

        .hud-header {
            font-family: var(--font-tech);
            font-size: 1.2rem;
            color: #fff;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--neon-purple);
            padding-bottom: 10px;
            letter-spacing: 1px;
        }

        /* Filter Items */
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 40px;
        }

        .filter-item {
            background: transparent;
            border: 1px solid #333;
            color: #888;
            padding: 12px 15px;
            text-align: left;
            font-family: var(--font-code);
            font-size: 0.85rem;
            cursor: pointer;
            transition: 0.3s;
            position: relative;
            overflow: hidden;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .filter-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 4px; height: 100%;
            background: #444;
            transition: 0.3s;
        }

        .filter-item:hover {
            background: rgba(255,255,255,0.05);
            color: #fff;
            border-color: #555;
        }

        .filter-item.active {
            background: rgba(0, 243, 255, 0.05);
            border-color: var(--neon-cyan);
            color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.1);
        }

        .filter-item.active::before {
            background: var(--neon-cyan);
            box-shadow: 0 0 8px var(--neon-cyan);
        }

        .filter-count {
            font-size: 0.7rem;
            background: #222;
            padding: 2px 6px;
            border-radius: 2px;
            color: #666;
        }
        .filter-item.active .filter-count {
            color: var(--neon-cyan);
            background: rgba(0,0,0,0.5);
        }

        /* Mini Stats in Sidebar */
        .hud-stats {
            margin-top: auto;
            border: 1px solid #333;
            padding: 15px;
            background: #0a0a0f;
        }
        .stat-row {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            margin-bottom: 5px;
            color: #666;
        }
        .stat-val { color: var(--neon-green); }

        /* --- Content Area (Timeline) --- */
        .archive-content {
            flex-grow: 1;
            margin-left: 280px; /* Offset for sidebar */
            padding: 50px 60px;
            position: relative;
        }

        .timeline-header {
            margin-bottom: 60px;
            padding-left: 30px;
        }
        .glitch-heading {
            font-family: var(--font-tech);
            font-size: 3rem;
            color: #fff;
            text-transform: uppercase;
            margin-bottom: 10px;
        }
        .timeline-desc {
            color: var(--text-muted);
            border-left: 3px solid var(--neon-purple);
            padding-left: 15px;
        }

        /* Timeline Structure */
        .timeline-wrapper {
            position: relative;
            padding-left: 30px;
        }

        /* The Main Vertical Line */
        .timeline-wrapper::before {
            content: '';
            position: absolute;
            top: 0; bottom: 0; left: 30px;
            width: 2px;
            background: #333;
            z-index: 0;
        }
        /* Glowing effect on the line */
        .timeline-wrapper::after {
            content: '';
            position: absolute;
            top: 0; bottom: 0; left: 30px;
            width: 2px;
            background: linear-gradient(to bottom, var(--neon-cyan), var(--neon-purple), transparent);
            opacity: 0.6;
            z-index: 0;
        }

        /* Year Group */
        .year-group {
            margin-bottom: 60px;
            position: relative;
        }

        .year-marker {
            font-family: var(--font-tech);
            font-size: 2rem;
            color: rgba(255,255,255,0.1);
            position: absolute;
            left: -20px;
            top: -40px;
            font-weight: 900;
            z-index: -1;
            pointer-events: none;
        }

        /* Article Node */
        .timeline-node {
            position: relative;
            margin-bottom: 40px;
            padding-left: 50px; /* Space from line */
            opacity: 0;
            animation: slideIn 0.5s forwards;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* The Dot on the line */
        .node-dot {
            position: absolute;
            left: 22px; /* Align with line center (30px) - half width */
            top: 25px;
            width: 16px;
            height: 16px;
            background: #000;
            border: 2px solid var(--neon-cyan);
            border-radius: 50%;
            z-index: 2;
            box-shadow: 0 0 10px var(--neon-cyan);
            transition: 0.3s;
        }

        .timeline-node:hover .node-dot {
            background: var(--neon-cyan);
            box-shadow: 0 0 20px var(--neon-cyan);
        }

        /* Connection Line (Horizontal) */
        .node-connector {
            position: absolute;
            left: 30px;
            top: 33px;
            width: 50px;
            height: 1px;
            background: var(--neon-cyan);
            opacity: 0.3;
        }

        /* The Card */
        .research-card-h {
            background: rgba(15, 15, 20, 0.8);
            border: 1px solid #333;
            border-left: 4px solid var(--text-muted);
            padding: 25px;
            position: relative;
            transition: 0.3s;
            margin-left: 30px; /* Distance from connector */
            clip-path: polygon(0 0, 100% 0, 100% calc(100% - 15px), calc(100% - 15px) 100%, 0 100%);
        }

        .research-card-h:hover {
            background: #15151e;
            border-color: #555;
            border-left-color: var(--neon-purple);
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        }

        .card-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            margin-bottom: 10px;
            color: #666;
        }
        .security-badge {
            border: 1px solid var(--neon-red);
            color: var(--neon-red);
            font-size: 0.6rem;
            padding: 1px 4px;
            letter-spacing: 1px;
        }

        .card-title {
            font-family: var(--font-tech);
            color: #fff;
            font-size: 1.4rem;
            margin-bottom: 10px;
        }
        .research-card-h:hover .card-title {
            color: var(--neon-cyan);
        }

        .card-summary {
            color: #aaa;
            font-size: 0.9rem;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .card-footer {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .tech-tag-sm {
            font-size: 0.75rem;
            color: #888;
            background: #111;
            padding: 2px 8px;
            border: 1px solid #333;
        }

        .access-btn {
            margin-left: auto;
            background: transparent;
            border: 1px solid var(--neon-cyan);
            color: var(--neon-cyan);
            font-size: 0.8rem;
            padding: 5px 15px;
            cursor: pointer;
            transition: 0.3s;
            font-family: var(--font-tech);
        }
        .access-btn:hover {
            background: rgba(0, 243, 255, 0.1);
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.2);
        }

        /* --- Responsive --- */
        @media (max-width: 992px) {
            .sidebar-hud {
                width: 100%;
                height: auto;
                position: relative;
                border-right: none;
                border-bottom: 1px solid #333;
                overflow-x: auto;
            }
            .filter-group {
                flex-direction: row;
                flex-wrap: wrap;
                margin-bottom: 20px;
            }
            .archive-content {
                margin-left: 0;
                padding: 30px 20px;
            }
            .hud-stats { display: none; } /* Hide stats on mobile */
        }
    </style>
</head>
<body>

<header class="navbar navbar-expand-lg fixed-top">
    <div class="container-fluid px-4">
        <a class="navbar-brand" href="index.html">LEO_CHAME_</a>
        <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <i class="bi bi-list text-white"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="index.html">01_HOME</a></li>
                <li class="nav-item"><a class="nav-link" href="tech.html">02_TECH</a></li>
                <li class="nav-item"><a class="nav-link active" href="research.html">03_RESEARCH</a></li>
                <li class="nav-item"><a class="nav-link" href="about.html">04_ABOUT</a></li>
            </ul>
        </div>
    </div>
</header>

<div class="archive-layout">

    <aside class="sidebar-hud">
        <div class="hud-header">
            <i class="bi bi-database-lock me-2"></i>ARCHIVE_FILTER
        </div>

        <div class="filter-group">
            <button class="filter-item active" data-category="all">
                <span>[ ALL_DATA ]</span> <span class="filter-count">--</span>
            </button>
            <button class="filter-item" data-category="经典论文">
                <span>PAPER_DECODE</span> <span class="filter-count" id="count-paper">0</span>
            </button>
            <button class="filter-item" data-category="MIT6.1810">
                <span>MIT_KERNEL</span> <span class="filter-count" id="count-mit">0</span>
            </button>
            <button class="filter-item" data-category="操作系统">
                <span>OS_CORE</span> <span class="filter-count" id="count-os">0</span>
            </button>
            <button class="filter-item" data-category="计算机基础">
                <span>CS_BASE</span> <span class="filter-count" id="count-cs">0</span>
            </button>
            <button class="filter-item" data-category="人工智能">
                <span>AI_LAB</span> <span class="filter-count" id="count-ai">0</span>
            </button>
        </div>

        <div class="hud-stats">
            <div class="text-white small mb-2 font-monospace" style="border-bottom: 1px solid #333; padding-bottom: 5px;">SYSTEM_STATUS</div>
            <div class="stat-row">
                <span>DATABASE:</span> <span class="stat-val">CONNECTED</span>
            </div>
            <div class="stat-row">
                <span>LATENCY:</span> <span class="stat-val">12ms</span>
            </div>
            <div class="stat-row">
                <span>SECURITY:</span> <span class="stat-val" style="color: var(--neon-red)">HIGH</span>
            </div>
            <div class="mt-3 text-muted" style="font-size: 0.65rem;">
                // ACCESS GRANTED<br>
                // USER: GUEST
            </div>
        </div>
    </aside>

    <main class="archive-content">
        <div class="timeline-header">
            <h1 class="glitch-heading">RESEARCH_LOGS</h1>
            <p class="timeline-desc">
                按时间轴归档的深度技术分析。<br>
                包含 <span style="color: var(--neon-green)">Kernel Trap</span> 机制源码拆解与 <span style="color: var(--neon-purple)">Attention</span> 论文复现记录。
            </p>
        </div>

        <div id="timeline-wrapper" class="timeline-wrapper">
            <div class="text-center py-5 text-muted">
                > DECRYPTING ARCHIVES...
            </div>
        </div>

        <div class="mt-5 pt-4 border-top border-dark d-flex justify-content-center">
            <nav aria-label="Page navigation">
                <ul class="pagination pagination-sm" id="pagination"></ul>
            </nav>
        </div>
    </main>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/articles.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const timelineWrapper = document.getElementById('timeline-wrapper');
        const filterItems = document.querySelectorAll('.filter-item');
        let currentCategory = 'all';

        // 模拟数据加载
        if (typeof articlesData === 'undefined') {
            console.error("Data Error");
            return;
        }

        // 1. 预处理数据：统计分类数量
        function updateCounts() {
            const counts = {
                '经典论文': 0, 'MIT6.1810': 0, '操作系统': 0,
                '计算机基础': 0, '人工智能': 0
            };

            articlesData.forEach(article => {
                if (!article.isResearch) return;
                if (article.mainCategory && counts.hasOwnProperty(article.mainCategory)) {
                    counts[article.mainCategory]++;
                }
                if (article.subCategory && article.subCategory.includes('MIT6.1810')) {
                    counts['MIT6.1810']++;
                }
            });

            document.getElementById('count-paper').innerText = counts['经典论文'];
            document.getElementById('count-mit').innerText = counts['MIT6.1810'];
            document.getElementById('count-os').innerText = counts['操作系统'];
            document.getElementById('count-cs').innerText = counts['计算机基础'];
            document.getElementById('count-ai').innerText = counts['人工智能'];
        }
        updateCounts();

        // 2. 渲染时间轴逻辑
        function renderTimeline(category) {
            timelineWrapper.innerHTML = '';

            // 筛选数据
            let filtered = articlesData.filter(a => a.isResearch);
            if (category !== 'all') {
                filtered = filtered.filter(article =>
                    article.mainCategory === category ||
                    (article.subCategory && article.subCategory.includes(category))
                );
            }

            // 按时间倒序
            filtered.sort((a, b) => new Date(b.date) - new Date(a.date));

            if (filtered.length === 0) {
                timelineWrapper.innerHTML = `<div class="text-muted pt-5">> NO RECORDS IN SECTOR [${category}]</div>`;
                return;
            }

            // 按年份分组
            const grouped = {};
            filtered.forEach(article => {
                const year = article.date.split('-')[0];
                if (!grouped[year]) grouped[year] = [];
                grouped[year].push(article);
            });

            // 渲染 HTML
            Object.keys(grouped).sort((a, b) => b - a).forEach(year => {
                // 年份标记
                const yearDiv = document.createElement('div');
                yearDiv.className = 'year-group';
                yearDiv.innerHTML = `<div class="year-marker">${year}</div>`;
                timelineWrapper.appendChild(yearDiv);

                // 文章节点
                grouped[year].forEach((article, index) => {
                    const node = document.createElement('div');
                    node.className = 'timeline-node';
                    node.style.animationDelay = `${index * 0.1}s`; // 瀑布流动画

                    // 生成随机的安全等级
                    const levels = ['LV.1 PUBLIC', 'LV.2 RESTRICTED', 'LV.3 CLASSIFIED'];
                    const secLevel = levels[Math.floor(Math.random() * levels.length)];

                    node.innerHTML = `
                        <div class="node-connector"></div>
                        <div class="node-dot"></div>
                        <div class="research-card-h" onclick="window.open('${article.link}', '_blank')">
                            <div class="card-meta">
                                <span style="color: var(--neon-cyan)">${article.date}</span>
                                <span class="security-badge">${secLevel}</span>
                            </div>
                            <h3 class="card-title">${article.title}</h3>
                            <p class="card-summary">${article.summary}</p>
                            <div class="card-footer">
                                <span class="tech-tag-sm">${article.mainCategory}</span>
                                ${article.subCategory ? `<span class="tech-tag-sm">${article.subCategory}</span>` : ''}
                                <button class="access-btn">ACCESS_FILE ></button>
                            </div>
                        </div>
                    `;
                    timelineWrapper.appendChild(node);
                });
            });
        }

        // 3. 初始化与事件绑定
        renderTimeline('all');

        filterItems.forEach(btn => {
            btn.addEventListener('click', function() {
                filterItems.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentCategory = this.getAttribute('data-category');
                renderTimeline(currentCategory);
            });
        });
    });
</script>
</body>
</html>