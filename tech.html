<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library — Leochame</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&family=Noto+Serif+SC:wght@300;400;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <style>
        :root {
            /* Anthropic-inspired Warm Palette */
            --bg-color: #F3F1E8;       /* 暖沙色 */
            --text-primary: #191919;   /* 深炭黑 */
            --text-secondary: #6E6D69; /* 暖灰 */
            --text-tertiary: #9E9D99;  /* 浅灰 */
            --accent-color: #C05838;   /* 陶土红 */
            --border-color: #D1D1C7;   /* 边框色 */

            --font-serif: "Noto Serif SC", "Merriweather", serif;
            --font-sans: "Inter", system-ui, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: var(--font-sans);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        a { text-decoration: none; color: inherit; transition: color 0.2s; }
        a:hover { color: var(--accent-color); }

        /* --- 1. Navbar: Clean & Aligned --- */
        .navbar {
            padding: 1.5rem 0;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--bg-color); /* Opaque background for sticky */
        }

        .navbar-brand {
            font-family: var(--font-serif);
            font-weight: 700;
            font-size: 1.3rem;
            letter-spacing: -0.5px;
            color: var(--text-primary) !important;
        }

        .nav-link {
            font-family: var(--font-sans);
            font-size: 0.9rem;
            color: var(--text-secondary) !important;
            font-weight: 500;
            margin-left: 2rem;
        }
        .nav-link.active { color: var(--text-primary) !important; font-weight: 600; }

        /* --- 2. Page Header: The Manifesto --- */
        .page-header {
            padding: 5rem 0 4rem;
            /* 取消底部边框，改用布局中的分割线 */
        }

        .page-title {
            font-family: var(--font-serif);
            font-size: 3.5rem;
            font-weight: 400;
            letter-spacing: -1px;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            line-height: 1.1;
        }

        .page-desc {
            font-family: var(--font-sans);
            font-size: 1.1rem;
            color: var(--text-secondary);
            max-width: 600px;
            line-height: 1.7;
        }

        /* --- 3. Layout Grid & Controls --- */
        /* 分割线：关键视觉元素 */
        .layout-divider {
            border-top: 1px solid var(--border-color);
            margin-bottom: 3rem;
        }

        .sidebar-sticky {
            position: sticky;
            top: 2rem;
        }

        /* Filters */
        .filter-group { margin-bottom: 3rem; }

        .filter-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            display: block;
            font-weight: 600;
        }

        .filter-list { list-style: none; padding: 0; margin: 0; }

        .filter-item {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 0.95rem;
            transition: all 0.2s;
            border-right: 2px solid transparent; /* Right border indicator */
        }

        .filter-item:hover { color: var(--text-primary); }

        .filter-item.active {
            color: var(--text-primary);
            font-weight: 600;
            border-right-color: var(--accent-color);
        }

        .count { font-size: 0.8rem; opacity: 0.5; }

        /* --- 4. Content Feed --- */

        /* Search Bar - Integrated into the flow */
        .feed-header {
            margin-bottom: 3rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
        }

        .search-input {
            width: 100%;
            background: transparent;
            border: none;
            font-family: var(--font-serif); /* Search feels like a title */
            font-size: 1.5rem;
            color: var(--text-primary);
            outline: none;
        }
        .search-input::placeholder { color: #D1D1C7; }

        /* Article Item */
        .article-item {
            display: block;
            margin-bottom: 4rem;
            transition: opacity 0.3s;
        }

        .article-meta {
            font-family: var(--font-sans);
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* Type Badges - Small, Minimal */
        .badge-type {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }
        .badge-tech { background: #E6EAEF; color: #2A4B6A; } /* Cool Blue/Grey */
        .badge-res { background: #EFEEE6; color: #8A3A3A; border: 1px solid #E0DCD0; } /* Warm Red/Grey */

        .article-title {
            font-family: var(--font-serif);
            font-size: 1.8rem;
            font-weight: 400; /* Elegant Regular weight */
            line-height: 1.3;
            margin-bottom: 1rem;
            color: var(--text-primary);
            transition: color 0.2s;
        }
        .article-item:hover .article-title { color: var(--accent-color); }

        .article-summary {
            font-size: 1.05rem;
            color: var(--text-secondary);
            line-height: 1.7;
            max-width: 720px;
            margin-bottom: 0;
        }

        /* Footer */
        .footer {
            margin-top: 6rem;
            padding: 4rem 0;
            border-top: 1px solid var(--border-color);
            color: var(--text-tertiary);
            font-size: 0.9rem;
        }

        @media (max-width: 992px) {
            .page-title { font-size: 2.5rem; }
            .sidebar-col { display: none; } /* Mobile: Hide sidebar, use simple stack */
            .search-input { font-size: 1.2rem; }
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg fixed-top">
    <div class="container">
        <a class="navbar-brand" href="index.html">Leochame.</a>
        <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <i class="bi bi-list" style="color:var(--text-primary)"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="index.html">Index</a></li>
                <li class="nav-item"><a class="nav-link active" href="articles.html">Library</a></li>
                <li class="nav-item"><a class="nav-link" href="about.html">Profile</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container" style="margin-top: 70px;">

    <header class="page-header">
        <div class="row">
            <div class="col-lg-8">
                <h1 class="page-title">The Archive</h1>
                <p class="page-desc">
                    A collection of engineering logs and research papers. <br>
                    Decoding the deterministic nature of systems and the probabilistic nature of intelligence.
                </p>
            </div>
        </div>
    </header>

    <div class="layout-divider"></div>

    <div class="row">
        <div class="col-lg-3 sidebar-col">
            <div class="sidebar-sticky">

                <div class="filter-group">
                    <span class="filter-label">Collection</span>
                    <ul class="filter-list">
                        <li class="filter-item active" data-type="all">
                            <span>View All</span>
                        </li>
                        <li class="filter-item" data-type="tech">
                            <span>Engineering</span>
                        </li>
                        <li class="filter-item" data-type="research">
                            <span>Research</span>
                        </li>
                    </ul>
                </div>

                <div class="filter-group">
                    <span class="filter-label">Topics</span>
                    <ul class="filter-list" id="topic-list">
                        <li class="filter-item active" data-category="all">
                            <span>All Topics</span>
                        </li>
                    </ul>
                </div>

            </div>
        </div>

        <div class="col-lg-9">

            <div class="feed-header">
                <input type="text" id="searchInput" class="search-input" placeholder="Search...">
                <i class="bi bi-search" style="color: var(--text-tertiary); font-size: 1.2rem;"></i>
            </div>

            <div id="feed-container">
                <div class="py-5 text-secondary">Loading library...</div>
            </div>

        </div>
    </div>
</div>

<footer class="footer container">
    <div class="row">
        <div class="col-md-6">© 2025 Liu Longchang</div>
        <div class="col-md-6 text-md-end">Designed with precision.</div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/articles.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const container = document.getElementById('feed-container');
        const topicListEl = document.getElementById('topic-list');
        const searchInput = document.getElementById('searchInput');
        const typeFilters = document.querySelectorAll('[data-type]');

        let state = {
            type: 'all',
            category: 'all',
            search: ''
        };

        if (typeof articlesData === 'undefined') {
            container.innerHTML = 'Data not loaded.';
            return;
        }

        // 1. Init Topics Sidebar
        function initTopics() {
            const cats = new Set();
            articlesData.forEach(a => cats.add(a.mainCategory));

            Array.from(cats).sort().forEach(cat => {
                const li = document.createElement('li');
                li.className = 'filter-item';
                li.setAttribute('data-category', cat);
                li.innerHTML = `<span>${cat}</span>`;

                li.addEventListener('click', () => {
                    document.querySelectorAll('[data-category]').forEach(el => el.classList.remove('active'));
                    li.classList.add('active');
                    state.category = cat;
                    render();
                });
                topicListEl.appendChild(li);
            });

            // Bind 'All Topics'
            document.querySelector('[data-category="all"]').addEventListener('click', function() {
                document.querySelectorAll('[data-category]').forEach(el => el.classList.remove('active'));
                this.classList.add('active');
                state.category = 'all';
                render();
            });
        }

        // 2. Render
        function render() {
            container.innerHTML = '';

            const filtered = articlesData.filter(article => {
                if (state.type === 'tech' && article.isResearch) return false;
                if (state.type === 'research' && !article.isResearch) return false;
                if (state.category !== 'all' && article.mainCategory !== state.category) return false;
                if (state.search) {
                    const q = state.search.toLowerCase();
                    return article.title.toLowerCase().includes(q) || article.summary.toLowerCase().includes(q);
                }
                return true;
            });

            filtered.sort((a, b) => new Date(b.date) - new Date(a.date));

            if (filtered.length === 0) {
                container.innerHTML = `<div class="py-5 text-secondary">No entries found.</div>`;
                return;
            }

            filtered.forEach((article, index) => {
                const item = document.createElement('a');
                item.href = article.link;
                item.target = "_blank";
                item.className = "article-item";
                item.style.opacity = '0';
                item.style.transform = 'translateY(10px)';

                setTimeout(() => {
                    item.style.transition = 'all 0.5s ease';
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, index * 30);

                // Date Logic
                const d = new Date(article.date);
                const dateStr = d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

                // Type Badge
                const badgeHtml = article.isResearch
                    ? `<span class="badge-type badge-res">Research</span>`
                    : `<span class="badge-type badge-tech">Log</span>`;

                item.innerHTML = `
                    <div class="article-meta">
                        <span style="font-variant-numeric: tabular-nums;">${dateStr}</span>
                        ${badgeHtml}
                        <span>${article.mainCategory}</span>
                    </div>
                    <h2 class="article-title">${article.title}</h2>
                    <p class="article-summary">${article.summary}</p>
                `;
                container.appendChild(item);
            });
        }

        // Events
        typeFilters.forEach(btn => {
            btn.addEventListener('click', function() {
                typeFilters.forEach(el => el.classList.remove('active'));
                this.classList.add('active');
                state.type = this.getAttribute('data-type');
                render();
            });
        });

        searchInput.addEventListener('input', (e) => {
            state.search = e.target.value;
            render();
        });

        initTopics();
        render();
    });
</script>

</body>
</html>